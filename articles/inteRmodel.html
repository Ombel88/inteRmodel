<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>inteRmodel • inteRmodel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="inteRmodel">
<meta property="og:description" content="inteRmodel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inteRmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/inteRmodel.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/llrs/inteRmodel/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>inteRmodel</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/inteRmodel/blob/master/vignettes/inteRmodel.Rmd"><code>vignettes/inteRmodel.Rmd</code></a></small>
      <div class="hidden name"><code>inteRmodel.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a><span class="header-section-number">1</span> Introduction</h1>
<p>The goal of inteRmodel is to provide the tools required to search for models in the generalized canonical correlations as provided by the <a href="https://cran.r-project.org/package=RGCCA">RGCCA</a> package.</p>
<p>You can read more about canonical correlation at (Tenenhaus and Tenenhaus, 2011) .</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">inteRmodel</span>)</pre></body></html></div>
<p>In this use case we want to find the best model to relate the gene expression on a glioma with some repetitions at the DNA level, taking into account that these tumors are at three different locations. Our idea is that the location might influence the tumor.</p>
</div>
<div id="data-format" class="section level1">
<h1 class="hasAnchor">
<a href="#data-format" class="anchor"></a><span class="header-section-number">2</span> Data format</h1>
<p>We use the data used on the vignette of the <a href="https://cran.r-project.org/package=RGCCA">RGCCA</a> package. We need the samples in the rows and the variables in the columns:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"ge_cgh_locIGR"</span>)
<span class="no">A</span> <span class="kw">&lt;-</span> <span class="no">ge_cgh_locIGR</span>$<span class="no">multiblocks</span>
<span class="no">Loc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ge_cgh_locIGR</span>$<span class="no">y</span>)
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">Loc</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">ge_cgh_locIGR</span>$<span class="no">multiblocks</span>$<span class="no">y</span>)
<span class="no">A</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">=</span> <span class="no">A</span><span class="kw">[[</span><span class="fl">3</span>]][, -<span class="fl">3</span>]
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">A</span>)[<span class="fl">3</span>] <span class="kw">&lt;-</span> <span class="st">"Loc"</span></pre></body></html></div>
<p>With these steps we read and prepare the data for the <code>sgcca</code> and <code>rgcca</code> function.</p>
</div>
<div id="workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow" class="anchor"></a><span class="header-section-number">3</span> Workflow</h1>
<p>The workflow is as follows:</p>
<ol style="list-style-type: decimal">
<li>Selecting the interaction-model</li>
<li>Evaluation of the models</li>
<li>Tuning the weight in the different interaction models</li>
<li>Comparison of the different models after bootstrapping</li>
</ol>
<p>These steps are explained in detail in the next sections.</p>
<div id="null-hypothesis" class="section level2">
<h2 class="hasAnchor">
<a href="#null-hypothesis" class="anchor"></a><span class="header-section-number">3.1</span> Null hypothesis</h2>
<p>Then we need to encode our hypothesis in a model, which takes the shape of a matrix. To ease the design of this model there are several functions available. The most important one is <code>subSymm</code>, which makes substitutions on symmetric matrices.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">C</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">A</span>), <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">A</span>)))
<span class="no">model0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/subSymm.html">subSymm</a></span>(<span class="no">C</span>, <span class="st">"GE"</span>, <span class="st">"CGH"</span>, <span class="fl">1</span>)
<span class="no">model0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/subSymm.html">subSymm</a></span>(<span class="no">model0</span>, <span class="st">"GE"</span>, <span class="st">"Loc"</span>, <span class="fl">1</span>)
<span class="no">model0</span>
<span class="co">#&gt;     GE CGH Loc</span>
<span class="co">#&gt; GE   0   1   1</span>
<span class="co">#&gt; CGH  1   0   0</span>
<span class="co">#&gt; Loc  1   0   0</span></pre></body></html></div>
<p>Here we hypothesize that the Agriculture and the industry are linked and that the agriculture is linked with the political block.</p>
</div>
<div id="search-models" class="section level2">
<h2 class="hasAnchor">
<a href="#search-models" class="anchor"></a><span class="header-section-number">3.2</span> Search models</h2>
<p>Now we look for the model that best relates these data.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">out_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model.html">search_model</a></span>(<span class="kw">A</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>), <span class="kw">scheme</span> <span class="kw">=</span> <span class="st">"horst"</span>,
               <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
               <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">A</span>)),
               <span class="kw">bias</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
This quickly explores over the 20 different models that could be the best ones. We can see that our hypothesis is in the upper middle:
<div class="figure">
<img src="inteRmodel_files/figure-html/hypotetical-1.png" alt="Figure 1: Histogram of the different inner AVE values of each model." width="672"><p class="caption">
Figure 1: Histogram of the different inner AVE values of each model.
</p>
</div>
<p>According to this, a better model would then be:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">columns</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"var"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">out_model</span>))
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/symm.html">symm</a></span>(<span class="no">C</span>, <span class="no">out_model</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">out_model</span>$<span class="no">AVE_inner</span>), <span class="no">columns</span>])
<span class="no">model</span>
<span class="co">#&gt;     GE CGH Loc</span>
<span class="co">#&gt; GE   0 0.0 1.0</span>
<span class="co">#&gt; CGH  0 0.0 0.5</span>
<span class="co">#&gt; Loc  1 0.5 0.0</span></pre></body></html></div>
<p>A model that instead of the expected relation between Agriculture and Industry block, they are both related to the Political block.</p>
</div>
<div id="refinement-of-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#refinement-of-the-model" class="anchor"></a><span class="header-section-number">3.3</span> Refinement of the model</h2>
<p>We further explore the relationships in this model:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">out_best</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model.html">iterate_model</a></span>(<span class="kw">C</span> <span class="kw">=</span> <span class="no">model</span>, <span class="kw">A</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>),
                          <span class="kw">scheme</span> <span class="kw">=</span> <span class="st">"horst"</span>,
                          <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                          <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">A</span>)),
                          <span class="kw">bias</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>We can see that usually the model is around 0.4 inner AVE.</p>
<div class="figure">
<img src="inteRmodel_files/figure-html/best_plot-1.png" alt="Figure 2: Histogram of the different inner AVE values of the same model but with different weights for those connections." width="672"><p class="caption">
Figure 2: Histogram of the different inner AVE values of the same model but with different weights for those connections.
</p>
</div>
<p>The best model would then be:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">model2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/symm.html">symm</a></span>(<span class="no">C</span>, <span class="no">out_best</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">out_best</span>$<span class="no">AVE_inner</span>), <span class="no">columns</span>])
<span class="no">model2</span>
<span class="co">#&gt;     GE CGH Loc</span>
<span class="co">#&gt; GE   0 0.0 1.0</span>
<span class="co">#&gt; CGH  0 0.0 0.1</span>
<span class="co">#&gt; Loc  1 0.1 0.0</span></pre></body></html></div>
</div>
<div id="evaluate-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-stability" class="anchor"></a><span class="header-section-number">3.4</span> Evaluate stability</h2>
<p>A next step would be to see if some models are better than the others, something along these lines but with more iterations.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">iterations</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="no">iterations</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">iterations</span>)) {
  <span class="no">index</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">A</span><span class="kw">[[</span><span class="fl">1</span>]]), <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
}
<span class="no">bs0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/boot.html">boot_index_sgcca</a></span>(<span class="no">index</span>, <span class="kw">A</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">C</span> <span class="kw">=</span> <span class="no">model0</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>))
<span class="no">bs1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/boot.html">boot_index_sgcca</a></span>(<span class="no">index</span>, <span class="kw">A</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">C</span> <span class="kw">=</span> <span class="no">model</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>))
<span class="no">bs2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/boot.html">boot_index_sgcca</a></span>(<span class="no">index</span>, <span class="kw">A</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">C</span> <span class="kw">=</span> <span class="no">model2</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>))</pre></body></html></div>
<div id="stability" class="section level3">
<h3 class="hasAnchor">
<a href="#stability" class="anchor"></a><span class="header-section-number">3.4.1</span> Stability</h3>
<p>We can see that they have different distributions:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.9</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>), <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"inner AVE"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"outer AVE"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Bootstrap of models"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">bs0</span>$<span class="no">AVE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">bs1</span>$<span class="no">AVE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"green"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">bs2</span>$<span class="no">AVE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"model2"</span>, <span class="st">"model"</span>, <span class="st">"model0"</span>),
       <span class="kw">fill</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>))

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span>(<span class="no">bs0</span>$<span class="no">AVE</span>, <span class="kw">Model</span> <span class="kw">=</span> <span class="st">"model 0"</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span>(<span class="no">bs1</span>$<span class="no">AVE</span>, <span class="kw">Model</span> <span class="kw">=</span> <span class="st">"model 1"</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span>(<span class="no">bs2</span>$<span class="no">AVE</span>, <span class="kw">Model</span> <span class="kw">=</span> <span class="st">"model 2"</span>))
<span class="no">agg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">df</span>[, <span class="fl">1</span>:<span class="fl">2</span>], <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Model</span> <span class="kw">=</span> <span class="no">df</span>$<span class="no">Model</span>), <span class="no">mean</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">agg</span>[, <span class="fl">2</span>:<span class="fl">3</span>], <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">17</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"black"</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.5</span>)</pre></body></html></div>
<div class="figure">
<img src="inteRmodel_files/figure-html/boot_plot-1.png" alt="Figure 3: Comparison of the models, our null hypothesis along the model with higest inner AVE. Triangles show the centroid of each group" width="672"><p class="caption">
Figure 3: Comparison of the models, our null hypothesis along the model with higest inner AVE. Triangles show the centroid of each group
</p>
</div>
<p>This suggests that the model2 has a higher inner AVE than the model0. With more iterations we could see if there is a tendency of a model to be more centered than the others. So, indicating that the model can better find the relationship between the blocks regardless of the input data.</p>
</div>
<div id="features" class="section level3">
<h3 class="hasAnchor">
<a href="#features" class="anchor"></a><span class="header-section-number">3.4.2</span> Features</h3>
<p>We can now analyze the canonical correlation for the weight of each variable.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">m2</span> <span class="kw">&lt;-</span> <span class="kw pkg">RGCCA</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RGCCA/man/sgcca.html">sgcca</a></span>(<span class="no">A</span>, <span class="no">model2</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>), <span class="kw">scheme</span> <span class="kw">=</span> <span class="st">"horst"</span>,
               <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">A</span>)),
               <span class="kw">bias</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">m0</span> <span class="kw">&lt;-</span> <span class="kw pkg">RGCCA</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RGCCA/man/sgcca.html">sgcca</a></span>(<span class="no">A</span>, <span class="no">model0</span>, <span class="kw">c1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.071</span>,<span class="fl">.2</span>, <span class="fl">1</span>), <span class="kw">scheme</span> <span class="kw">=</span> <span class="st">"horst"</span>,
               <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">A</span>)),
               <span class="kw">bias</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>We can now explore the position of each sample:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">pars</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">m0</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">1</span>]][, <span class="fl">1</span>], <span class="no">m0</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">2</span>]][, <span class="fl">1</span>], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Block1 Comp1"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Block2 Comp1"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Initial model"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">v</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">m0</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">1</span>]][, <span class="fl">1</span>], <span class="no">m0</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">2</span>]][, <span class="fl">1</span>], <span class="kw">labels</span> <span class="kw">=</span> <span class="no">Loc</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">Loc</span>)+<span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">m2</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">1</span>]][, <span class="fl">1</span>], <span class="no">m2</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">2</span>]][, <span class="fl">1</span>], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Block1 Comp1"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Block2 Comp1"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Final model"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">v</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">m2</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">1</span>]][, <span class="fl">1</span>], <span class="no">m2</span>$<span class="no">Y</span><span class="kw">[[</span><span class="fl">2</span>]][, <span class="fl">1</span>], <span class="kw">labels</span> <span class="kw">=</span> <span class="no">Loc</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">Loc</span>)+<span class="fl">1</span>)</pre></body></html></div>
<div class="figure">
<img src="inteRmodel_files/figure-html/m1-1.png" alt="Figure 4: Differences on the canonical dimensions of the samples" width="672"><p class="caption">
Figure 4: Differences on the canonical dimensions of the samples
</p>
</div>
<!-- Change the sentence--->
<p>Although there is a relative difference in the general outcome, what has changed more is the importance of each variable. As we can see here:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="no">pars</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">m0</span>$<span class="no">a</span>$<span class="no">CGH</span>[, <span class="fl">1</span>], <span class="no">m2</span>$<span class="no">a</span>$<span class="no">CGH</span>[, <span class="fl">1</span>], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"CGH variables importance"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"model0"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"model2"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>)</pre></body></html></div>
<div class="figure">
<img src="inteRmodel_files/figure-html/unnamed-chunk-1-1.png" alt="Figure 5: Comparison of the weights of the CGH variables" width="672"><p class="caption">
Figure 5: Comparison of the weights of the CGH variables
</p>
</div>
<p>Where some variables that had a weight of 0 in model 0 become important and some variables that were important that no longer have any weight on the model 2.</p>
</div>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a><span class="header-section-number">4</span> Conclusion</h1>
<p>Finding a different model that explains your data better challenges the assumptions about the data. By comparing models, we can learn which blocks of variables are connected thus showing new relationships. These new relationships consider the same variables but with different importance, which, with the right model, should be more accurate.</p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a><span class="header-section-number">5</span> Session Info</h1>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 4.0.0 (2020-04-24)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so</span>
<span class="co">#&gt; LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] inteRmodel_0.1.1     knitcitations_1.0.10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.4.6      knitr_1.28        xml2_1.3.2        magrittr_1.5     </span>
<span class="co">#&gt;  [5] MASS_7.3-51.5     lattice_0.20-41   R6_2.4.1          rlang_0.4.6      </span>
<span class="co">#&gt;  [9] bibtex_0.4.2.2    stringr_1.4.0     httr_1.4.1        highr_0.8        </span>
<span class="co">#&gt; [13] plyr_1.8.6        tools_4.0.0       grid_4.0.0        xfun_0.13        </span>
<span class="co">#&gt; [17] RGCCA_2.1.2       htmltools_0.4.0   yaml_2.2.1        digest_0.6.25    </span>
<span class="co">#&gt; [21] Matrix_1.2-18     RefManageR_1.2.12 curl_4.3          evaluate_0.14    </span>
<span class="co">#&gt; [25] rmarkdown_2.1     stringi_1.4.6     compiler_4.0.0    generics_0.0.2   </span>
<span class="co">#&gt; [29] jsonlite_1.6.1    lubridate_1.7.8</span></pre></body></html></div>
</div>
<div id="bibliography" class="section level1">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a><span class="header-section-number">6</span> Bibliography</h1>
<p>[1] A. Tenenhaus and M. Tenenhaus. “Regularized Generalized Canonical Correlation Analysis”. In: <em>Psychometrika</em> 76.2 (Mar. 2011), pp. 257-284. DOI: 10.1007/s11336-011-9206-8. &lt;URL: <a href="https://doi.org/10.1007/s11336-011-9206-8" class="uri">https://doi.org/10.1007/s11336-011-9206-8</a>&gt;.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
